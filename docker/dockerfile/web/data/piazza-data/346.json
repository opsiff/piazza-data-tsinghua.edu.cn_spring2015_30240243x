{"aid": "igkpp6znpk1747", "error": null, "result": {"default_anonymity": "no", "status": "active", "i_edits": [], "q_edits": [], "bookmarked": 3, "request_instructor": 0, "history": [{"uid": "i71i9b92nrr7n4", "anon": "no", "created": "2015-04-22T08:23:48Z", "content": "<p>lab4當中為中断标記設置的兩個宏　(如下)</p>\n<p></p>\n<p>sync.h</p>\n<p></p>\n<p>#define local_intr_save(x)      do { x = __intr_save(); } while (0)<br />#define local_intr_restore(x)   __intr_restore(x);</p>\n<p></p>\n<p>请问为什么local_intr_save需要以do {   } while (0)包著核心部分的x = __intr_save();? 有什么安全原因么</p>\n<p></p>\n<p>另外是result中,　proc.c裡proc_run中的這一段</p>\n<p></p>\n<p>    bool intr_flag;<br />    local_intr_save(intr_flag);<br />    {<br />        proc-&gt;pid = get_pid();<br />        hash_proc(proc);<br />        list_add(&amp;proc_list, &amp;(proc-&gt;list_link));<br />        nr_process &#43;&#43;;<br />    }<br />    local_intr_restore(intr_flag);</p>\n<p></p>\n<p>看不太出來設置中断标記的必要, 求讲解 &#64;&#64;</p>", "subject": "关于lab4, local_intr_save/restore"}, {"uid": "i71i9b92nrr7n4", "anon": "no", "created": "2015-04-22T08:17:35Z", "content": "<p>lab4當中為中断标記設置的兩個宏　(如下)</p>\n<p></p>\n<p>sync.h</p>\n<p></p>\n<p>#define local_intr_save(x)      do { x = __intr_save(); } while (0)<br />#define local_intr_restore(x)   __intr_restore(x);</p>\n<p></p>\n<p>请问为什么local_intr_save需要以do {   } while (0)包著核心部分的x = __intr_save();? 有什么安全原因么 &#64;&#64;</p>", "subject": "关于lab4, local_intr_save"}], "s_edits": [], "is_bookmarked": false, "tag_good_arr": [], "request_instructor_me": false, "my_favorite": false, "t": 1446635960482, "children": [{"is_tag_endorse": false, "created": "2015-04-23T04:51:30Z", "id": "i8tozbibq8g2nk", "tag_endorse": [], "folders": [], "history": [{"uid": "hs2swpdtr91gu", "anon": "no", "created": "2015-04-23T04:51:30Z", "content": "<p>为了保证操作的原子性&#xff0c;不会被中断打断。可以参考以下的讨论 <a href=\"https://www.piazza.com/class/i5j09fnsl7k5x0?cid=309\">https://piazza.com/class/i5j09fnsl7k5x0?cid=309</a> </p>", "subject": ""}], "config": {}, "data": {"embed_links": []}, "bucket_order": 2, "bucket_name": "Today", "tag_endorse_arr": [], "children": [], "type": "i_answer"}], "type": "question", "unique_views": 56, "created": "2015-04-22T08:17:35Z", "id": "i8sgwi3mvwo3h7", "no_answer": 0, "nr": 346, "data": {"embed_links": []}, "upvote_ids": [], "is_tag_good": false, "config": {}, "folders": ["lab4"], "bucket_order": 2, "change_log": [{"uid": "i71i9b92nrr7n4", "when": "2015-04-22T08:17:35Z", "data": "i8sgwi3p35b3h8", "anon": "no", "type": "create"}, {"uid": "i71i9b92nrr7n4", "when": "2015-04-22T08:23:48Z", "data": "i8sh4htkzio6np", "anon": "no", "type": "update"}, {"uid": "hs2swpdtr91gu", "when": "2015-04-23T04:51:30Z", "data": "i8tozbkopmi2nl", "to": "i8sgwi3mvwo3h7", "anon": "no", "type": "i_answer"}], "bucket_name": "Today", "tags": ["lab4", "student"], "no_answer_followup": 0, "num_favorites": 0, "tag_good": []}}