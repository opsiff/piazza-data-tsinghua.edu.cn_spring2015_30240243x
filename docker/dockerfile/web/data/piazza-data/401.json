{"aid": "igkpveayf2d11a", "error": null, "result": {"default_anonymity": "no", "status": "active", "i_edits": [], "q_edits": [], "bookmarked": 3, "request_instructor": 0, "history": [{"uid": "i74g3aomM8b", "anon": "no", "created": "2015-05-07T14:30:45Z", "content": "<p>对labcodes_answer/lab3_result中的swap_fifo.c做patch如下&#xff1a;</p>\n<pre>--- kern/mm/swap_fifo.c\t2015-05-07 22:11:17.066648874 &#43;0800\n&#43;&#43;&#43; kern/mm/swap_fifo.c\t2015-05-07 22:11:14.819982267 &#43;0800\n&#64;&#64; -6,6 &#43;6,27 &#64;&#64;\n #include &lt;swap_fifo.h&gt;\n #include &lt;list.h&gt;\n \n&#43;struct mm_struct global_mm;\n&#43;void clear_list(){\n&#43;    int i;\n&#43;    cprintf(&#34;Start Clear List\\n&#34;);\n&#43;    for(i=0x1000; i&lt;=0x5000; i&#43;=0x1000){\n&#43;        pte_t *ptep = get_pte(global_mm.pgdir, i, 0);\n&#43;        (*ptep) &amp;= ~PTE_A;\n&#43;    }\n&#43;    cprintf(&#34;End Clear List\\n&#34;);\n&#43;}\n&#43;\n&#43;void print_list(){\n&#43;    int i;\n&#43;    cprintf(&#34;Start Print List\\n&#34;);\n&#43;    for(i=0x1000;i&lt;=0x5000;i&#43;=0x1000){\n&#43;        pte_t *ptep = get_pte(global_mm.pgdir, i, 0);\n&#43;        cprintf(&#34;%d\\t&#34;, !!((*ptep) &amp; PTE_A));\n&#43;    }\n&#43;    cprintf(&#34;\\nEnd Start List\\n&#34;);\n&#43;}\n&#43;\n /* [wikipedia]The simplest Page Replacement Algorithm(PRA) is a FIFO algorithm. The first-in, first-out\n  * page replacement algorithm is a low-overhead algorithm that requires little book-keeping on\n  * the part of the operating system. The idea is obvious from the name - the operating system\n&#64;&#64; -44,6 &#43;65,7 &#64;&#64;\n static int\n _fifo_map_swappable(struct mm_struct *mm, uintptr_t addr, struct Page *page, int swap_in)\n {\n&#43;    global_mm = *mm;\n     list_entry_t *head=(list_entry_t*) mm-&gt;sm_priv;\n     list_entry_t *entry=&amp;(page-&gt;pra_page_link);\n  \n&#64;&#64; -87,12 &#43;109,17 &#64;&#64;\n     assert(pgfault_num==4);\n     cprintf(&#34;write Virt Page b in fifo_check_swap\\n&#34;);\n     *(unsigned char *)0x2000 = 0x0b;\n&#43;    print_list();\n&#43;    clear_list();\n&#43;    print_list();\n     assert(pgfault_num==4);\n     cprintf(&#34;write Virt Page e in fifo_check_swap\\n&#34;);\n     *(unsigned char *)0x5000 = 0x0e;\n&#43;    print_list();\n     assert(pgfault_num==5);\n     cprintf(&#34;write Virt Page b in fifo_check_swap\\n&#34;);\n     *(unsigned char *)0x2000 = 0x0b;\n&#43;    print_list();\n     assert(pgfault_num==5);\n     cprintf(&#34;write Virt Page a in fifo_check_swap\\n&#34;);\n     *(unsigned char *)0x1000 = 0x0a;\n</pre>\n<p>一开始访问a、b、c、d之后前四个PTE_A置上了&#xff1a;</p>\n<p>1       1       1       1       0</p>\n<p>然后清空PTE_A&#xff1a;</p>\n<p>0       0       0       0       0</p>\n<p>然后访问e&#xff1a;</p>\n<p>0       0       0       0       1</p>\n<p>奇怪的是然后访问b之后</p>\n<p>0       0       0       0       1</p>\n<p>为什么这里b的PTE_A没有置一那&#xff1f;</p>", "subject": "lab3中CPU为什么不会自动为PTE_A置一&#xff1f;"}], "s_edits": [], "is_bookmarked": false, "tag_good_arr": [], "request_instructor_me": false, "my_favorite": false, "t": 1446636249898, "children": [{"is_tag_endorse": false, "created": "2015-05-08T00:02:22Z", "id": "i9eu99syez04sd", "tag_endorse": [{"class_sections": ["课程设计_i5j09fnsl7k5x0"], "name": "Yue Kai", "id": "i74g3aomM8b", "role": "student", "facebook_id": null, "photo": null, "admin": false, "us": false}], "folders": [], "history": [{"uid": "hdjoucuyb836fq", "anon": "no", "created": "2015-05-08T00:02:22Z", "content": "<p>Please refer to: <a href=\"https://www.piazza.com/class/i5j09fnsl7k5x0?cid=336\">https://piazza.com/class/i5j09fnsl7k5x0?cid=336</a></p>", "subject": ""}], "config": {}, "data": {"embed_links": []}, "bucket_order": 2, "bucket_name": "Today", "tag_endorse_arr": ["i74g3aomM8b"], "children": [], "type": "i_answer"}], "type": "question", "unique_views": 45, "created": "2015-05-07T14:30:45Z", "id": "i9e9u62bawp1ph", "no_answer": 0, "nr": 401, "data": {"embed_links": []}, "upvote_ids": [], "is_tag_good": false, "config": {}, "folders": ["lab3"], "bucket_order": 2, "change_log": [{"uid": "i74g3aomM8b", "when": "2015-05-07T14:30:45Z", "data": "i9e9u63jeo71pi", "anon": "no", "type": "create"}, {"uid": "hdjoucuyb836fq", "when": "2015-05-08T00:02:22Z", "data": "i9eu99t1b4se", "to": "i9e9u62bawp1ph", "anon": "no", "type": "i_answer"}], "bucket_name": "Today", "tags": ["lab3", "student"], "no_answer_followup": 0, "num_favorites": 0, "tag_good": []}}