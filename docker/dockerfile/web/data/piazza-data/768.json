{"aid": "imm5lqp9ngb5ok", "result": {"folders": ["lab5"], "unique_views": 34, "no_answer": 0, "change_log": [{"data": "imlkgk8ntyt2d8", "anon": "no", "when": "2016-04-04T05:38:39Z", "uid": "i0nuu5yhgno5tv", "type": "create"}, {"uid": "ie7xy71bn7b1s2", "data": "imlmxh3msoe6sv", "when": "2016-04-04T06:47:48Z", "to": "imlkgk8k4a92d7", "anon": "no", "type": "s_answer"}, {"data": "imlmy7s79lo1vl", "anon": "no", "when": "2016-04-04T06:48:22Z", "uid": "ie7xy71bn7b1s2", "type": "s_answer_update"}, {"to": "imlkgk8k4a92d7", "anon": "no", "when": "2016-04-04T07:30:38Z", "uid": "i0b2fq3ezjw50r", "type": "followup"}, {"to": "imlkgk8k4a92d7", "anon": "no", "when": "2016-04-04T08:17:56Z", "uid": "i0nuu5yhgno5tv", "type": "followup"}, {"to": "imlkgk8k4a92d7", "anon": "no", "when": "2016-04-04T08:51:16Z", "uid": "i0f24oie8102cr", "type": "feedback"}, {"to": "imlkgk8k4a92d7", "anon": "no", "when": "2016-04-04T09:00:19Z", "uid": "i0nuu5yhgno5tv", "type": "feedback"}, {"to": "imlkgk8k4a92d7", "anon": "no", "when": "2016-04-04T09:11:55Z", "uid": "i0f24oie8102cr", "type": "feedback"}, {"to": "imlkgk8k4a92d7", "anon": "no", "when": "2016-04-04T14:16:54Z", "uid": "ie7xy71bn7b1s2", "type": "feedback"}], "upvote_ids": [], "id": "imlkgk8k4a92d7", "bookmarked": 6, "no_answer_followup": 2, "i_edits": [], "is_bookmarked": false, "children": [{"folders": [], "is_tag_endorse": false, "created": "2016-04-04T06:47:48Z", "config": {}, "tag_endorse_arr": [], "children": [], "bucket_name": "Today", "type": "s_answer", "tag_endorse": [], "bucket_order": 2, "data": {"embed_links": []}, "id": "imlmxh3jmdx6su", "history": [{"content": "<p>current-&gt;tf主要是给各个系统调用传参, 系统调用压寄存器的那些参数都在tf里面</p>\n<p>Trapframe Chain的作用是用于处理嵌套中断/异常</p>\n<p>因为current-&gt;tf是不能嵌套的, 只有一个位置, 那么只能找一个地方放old trapframe, 等到嵌套的中断返回到上一层中断, 如果没有old trapframe的话current-&gt;tf就错了(还是刚刚返回的中断的tf), 然后就会崩得一塌糊涂.</p>", "anon": "no", "subject": "", "uid": "ie7xy71bn7b1s2", "created": "2016-04-04T06:48:22Z"}, {"content": "<p>current-&gt;tf主要是给各个系统调用传参, 系统调用压寄存器的那些参数都在tf里面</p>\n<p>Trapframe Chain的作用是用于处理嵌套中断/异常</p>\n<p>因为current-&gt;tf是不能嵌套的, 只有一个位置, 那么只能找一个地方放old trapframe, 等到嵌套的中断返回到上一层中断, 如果没有old trapframe的话trap frame就错了, 然后就会崩得一塌糊涂.</p>", "anon": "no", "subject": "", "uid": "ie7xy71bn7b1s2", "created": "2016-04-04T06:47:48Z"}]}, {"folders": [], "updated": "2016-04-04T07:30:38Z", "no_upvotes": 0, "uid": "i0b2fq3ezjw50r", "created": "2016-04-04T07:30:38Z", "type": "followup", "d-bucket": "Yesterday", "id": "imlogk7tn5k4pc", "anon": "no", "bucket_name": "Yesterday", "no_answer": 1, "config": {}, "bucket_order": 3, "data": null, "children": [], "subject": "<p>所以你的意思是这个保存是为了可以嵌套&#xff1f;</p>"}, {"folders": [], "updated": "2016-04-04T08:17:56Z", "no_upvotes": 0, "uid": "i0nuu5yhgno5tv", "created": "2016-04-04T08:17:56Z", "type": "followup", "d-bucket": "Yesterday", "id": "imlq5e856f411o", "anon": "no", "bucket_name": "Yesterday", "no_answer": 1, "config": {}, "bucket_order": 3, "data": null, "children": [{"folders": [], "updated": "2016-04-04T08:51:16Z", "uid": "i0f24oie8102cr", "created": "2016-04-04T08:51:16Z", "type": "feedback", "d-bucket": "Yesterday", "id": "imlrc95fcrp6fp", "anon": "no", "bucket_name": "Yesterday", "config": {}, "bucket_order": 3, "data": null, "children": [], "subject": "<p>硬件做了些事情吧</p>"}, {"folders": [], "updated": "2016-04-04T09:00:19Z", "uid": "i0nuu5yhgno5tv", "created": "2016-04-04T09:00:19Z", "type": "feedback", "d-bucket": "Yesterday", "id": "imlrnwekwnn17d", "anon": "no", "bucket_name": "Yesterday", "config": {}, "bucket_order": 3, "data": null, "children": [], "subject": "<p>硬件就是根据tss的esp0切换堆栈呗。</p>"}, {"folders": [], "updated": "2016-04-04T09:11:55Z", "uid": "i0f24oie8102cr", "created": "2016-04-04T09:11:55Z", "type": "feedback", "d-bucket": "Yesterday", "id": "imls2tjh98n5ow", "anon": "no", "bucket_name": "Yesterday", "config": {}, "bucket_order": 3, "data": null, "children": [], "subject": "<p>有木有做别的&#xff1f;比如压一些东西什么的&#xff1f;</p>\n<p>你用gdb调试的还是纯看代码&#xff1f;</p>"}, {"folders": [], "updated": "2016-04-04T14:16:54Z", "uid": "ie7xy71bn7b1s2", "created": "2016-04-04T14:16:54Z", "type": "feedback", "id": "imm2z1co5p34c9", "anon": "no", "bucket_name": "Today", "config": {}, "bucket_order": 2, "data": null, "children": [], "subject": "<p>中断嵌套是中断里套中断, 和proc_run没有关系. </p>"}], "subject": "<p>但是又一个问题&#xff0c;在proc_run里面的</p>\n<pre>load_esp0(next-&gt;kstack &#43; KSTACKSIZE);</pre>\n<p>实际上tss里面的esp0和整个proc_struct的trapframe的地址是一样的。也就是说每次中断的时候&#xff0c;trap函数里的trapframe和proc_struct的trapframe地址应该是一样的。那嵌套没法处理啊。。。</p>"}], "request_instructor_me": false, "nr": 768, "bucket_order": 2, "config": {}, "status": "active", "tags": ["lab5", "student"], "num_favorites": 0, "bucket_name": "Today", "q_edits": [], "data": {"embed_links": []}, "request_instructor": 0, "created": "2016-04-04T05:38:39Z", "is_tag_good": false, "type": "question", "s_edits": [], "my_favorite": false, "default_anonymity": "no", "t": 1459783833453, "tag_good": [{"name": "张明瑞 2013011391", "admin": false, "photo": "1421470584_35.png", "us": false, "email": "zhangmr13@mails.tsinghua.edu.cn", "class_sections": ["清华学生_i5j09fnsl7k5x0"], "role": "student", "facebook_id": null, "id": "i0b2fq3ezjw50r"}, {"name": "叶子鹏", "admin": false, "photo": null, "us": false, "email": "775193759@qq.com", "class_sections": ["清华学生_i5j09fnsl7k5x0"], "role": "student", "facebook_id": null, "id": "i0f24oie8102cr"}], "tag_good_arr": ["i0b2fq3ezjw50r", "i0f24oie8102cr"], "history": [{"content": "<p>看了lab5的代码有几个问题。</p>\n<p>1. proc_struct中的trapframe只有在第一次switch_to的时候充当一个临时的trapframe用来提供iret返回的作用。之后这个trapframe还有别的用处吗&#xff1f;我没有看到还有其他地方需要用这个。</p>\n<p>2. 下面代码中的trapframe chain是什么东西- -。为啥要维护这么一个东西。</p>\n<pre>void\ntrap(struct trapframe *tf) {\n    // dispatch based on what type of trap occurred\n    // used for previous projects\n    if (current == NULL) {\n        trap_dispatch(tf);\n    }\n    else {\n        // keep a trapframe chain in stack\n        struct trapframe *otf = current-&gt;tf;\n        current-&gt;tf = tf;\n    \n        bool in_kernel = trap_in_kernel(tf);\n    \n        trap_dispatch(tf);\n    \n        current-&gt;tf = otf;\n        if (!in_kernel) {\n            if (current-&gt;flags &amp; PF_EXITING) {\n                do_exit(-E_KILLED);\n            }\n            if (current-&gt;need_resched) {\n                schedule();\n            }\n        }\n    }\n}</pre>\n<p></p>", "anon": "no", "subject": "proc_struct中trapframe的作用", "uid": "i0nuu5yhgno5tv", "created": "2016-04-04T05:38:39Z"}]}, "error": null}